<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <!--<link th:href="@{/css/bootstrap.min.css}"  href="../../static/css/bootstrap.min.css" rel="stylesheet">-->
    <link href="https://cdn.bootcss.com/twitter-bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
    <link th:href="@{/css/bootstrap-table.min.css}"  href="../../static/css/bootstrap-table.min.css" rel="stylesheet">
    <script th:src="@{/js/jquery-3.4.1.min.js}"  src="../../static/js/jquery-3.4.1.min.js" type="text/javascript"></script>
    <!--<script src="../../static/js/bootstrap.min.js" th:src="@{/js/bootstrap.min.js}" type="text/javascript"></script>-->
    <script src="https://cdn.bootcss.com/twitter-bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="../../static/js/lib/bootstrap-table.min.js" th:src="@{/js/lib/bootstrap-table.min.js}" type="text/javascript"></script>
    <script src="../../static/js/lib/bootstrap-table-zh-CN.min.js" th:src="@{/js/lib/bootstrap-table-zh-CN.min.js}" type="text/javascript"></script>
    <script src="../../static/js/lib/sweetalert.min.js" th:src="@{/js/lib/sweetalert.min.js}"></script>
    <script src="../../static/js/lib/es6-promise.auto.min.js" th:src="@{/js/lib/es6-promise.auto.min.js}"></script>
    <!--<script src="../../static/js/lib/popper.min.js" th:src="@{/js/lib/popper.min.js}"></script>-->
    <script src="../../static/js/common.js" th:src="@{/js/common.js}" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" th:href="@{/css/usertable.css}" href="../../static/css/usertable.css">
</head>
<body onload="init();">

<div id="toolbar" class="btn-group">
    <button id="btn_delete" type="button" class="btn btn-default" onclick="deleteAll();">
        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>删除
    </button>
</div>
<table id="table">

</table>
<!-- 模态框-详情 -->
<div aria-hidden="true" aria-labelledby="exact" class="modal fade" id="exact" role="dialog" tabindex="-1">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header" style="background-color: rgb(226, 203, 145);">
                <h5 class="modal-title" id="payforroomLabel1">详细信息</h5>
                <button aria-label="close" class="close" data-dismiss="modal" type="button">
                    <Span aria-hidden="true">&times;</Span>
                </button>
            </div>
            <div class="modal-body" style="height: 300px;">
                <div class="container">
                    <div class="p-left">
                        <p >订单编号：</p><span id="text1"></span><br>
                        <p >房间号：</p><span id="text2"></span><br>
                        <p >客户编号：</p><span id="text3"></span><br>
                        <p >处理员工编号：</p><span id="text4"></span><br>
                        <p >实际付款金额：</p><span id="text5"></span><br>
                    </div>
                    <div class="p-right">
                        <p >预计入住时间间隔：</p><span id="text6"></span><br>
                        <p >入住时间：</p><span id="text7"></span><br>
                        <p >退房时间：</p><span id="text8"></span><br>
                        <p >评价：</p><span id="text9"></span><br>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    // 构造表格
    initTable($('#table'), [10, 25, 100, 100],
        [{
            checkbox: true
        }, {
            field: 'id',
            title: '订单编号',
            width: '40px'
        }, {
            field: 'numbers',
            title: '菜品份数',
            width: '40px'
        }, {
            field: 'customerId',
            title: '客户编号',
            width: '100px'
        },{
            field: 'payMoney',
            title: '实际付款金额',
            width: '50px'
        },{
            title: '操作',
            width: '100px',
            formatter: operateFormatter // 自定义方法，添加操作按钮
        }]);

    function operateFormatter(value, row, index) {  // 赋予的参数
        return [
            '<button class="btn btn-success view" data-toggle="modal" data-target="#exact" onclick="view('+ index +');">查看</button>&nbsp;&nbsp;' +
            '<a href="/hotel/customer/show-customerupdate"><button class="btn btn-primary view" data-toggle="modal" data-target="#editModal" onclick="initEdit('+ index +');">编辑</button></a>&nbsp;&nbsp;' +
            '<button class="btn btn-danger view" onclick="deleteOne('+ index +');">删除</button>&nbsp;&nbsp;'
        ].join('');
    }

    // 初始化表格信息
    function init() {
        noParameterPostRequest("/hotel/order/get-list", result => {
            console.info(result);
            let data = { total: result.module.length, rows: result.module };
            $("#table").bootstrapTable("load", data);
        });
    }

    // 删除
    function deleteAll() {
        dialog("确定删除吗？", () => {
            let filNames = $("#table").bootstrapTable('getSelections');
            parameterPostRequest("/hotel/order/delete-byidlist", filNames.map(item => item.id), () => {
                swal("删除", "文件删除成功", "success");
                init();
            });
        });
    }

    // 查看
    function view(index) {
        let rows = $("#table").bootstrapTable('getData');
        $("#text1").text(rows[index].id);
        $("#text2").text(rows[index].roomNumber);
        $("#text3").text(rows[index].customerId);
        $("#text4").text(rows[index].staffId);
        $("#text5").text(rows[index].payMoney);
        $("#text6").text(rows[index].precheckInTime);
        $("#text7").text(rows[index].checkInTime);
        $("#text8").text(rows[index].checkOutTime);
        $("#text9").text(rows[index].evaluate);
    }
</script>
</body>
</html>